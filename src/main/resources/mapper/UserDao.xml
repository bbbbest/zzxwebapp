<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.zzx.dao.UserDao">
    <insert id="insert" parameterType="User" statementType="PREPARED" flushCache="true">
        INSERT INTO
        `user`(userName, `password`, `name`,cardNumber,score, phone, `status`, balance)
        VALUES
        <trim prefix="(" suffix=")">
            #{username}, #{password}, #{name},
            <choose>
                <when test="cardNumber != null ">
                    #{cardNumber},
                </when>
                <when test="cardNumber == null ">
                    -1,
                </when>
            </choose>
            #{score}, #{phone}, #{status}, #{balance}
        </trim>
    </insert>
    <delete id="delete" parameterType="User" flushCache="true" statementType="PREPARED">
        DELETE FROM user
        WHERE userId = #{userId}
    </delete>
    <update id="update" parameterType="User" flushCache="true" statementType="PREPARED">
        UPDATE user SET
        <set>
            <if test="password != null ">
                `password` = #{password},
            </if>
            <if test="name != null ">
                `name` = #{name},
            </if>
            <if test="cardNumber != null and cardNumber > 0">
                cardNumber = #{cardNumber},
            </if>
            <if test="phone != null ">
                phone = #{phone},
            </if>
            <if test="status != null ">
                `status` = #{status},
            </if>
            <if test="score != null ">
                score = #{score}
            </if>
            <if test="balance != null ">
                balance = #{balance},
            </if>
        </set>
        WHERE userId = #{userId}
    </update>
    <select id="selectTotal" resultType="int" statementType="PREPARED" useCache="true">
        SELECT count(*)
        FROM user
    </select>
    <select id="selectByPage" resultType="User" statementType="PREPARED" useCache="true">
        SELECT *
        FROM user
        LIMIT #{start}, #{pageSize}
    </select>
</mapper>